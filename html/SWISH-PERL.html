<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
  <head>
   <title>SWISH-Enhanced:  Perl Interface to the SWISH-E Library </title>
   <link href="./style.css" rel=stylesheet type="text/css" title="refstyle">
  </head>
  <body>

    <h1 class="banner">
        <img src="images/swish.gif" alt="Swish-E Logo"><br>
        <img src="images/swishbanner1.gif"><br>
        <img src="images/dotrule1.gif"><br>
         Perl Interface to the SWISH-E Library 
    </h1>

    <hr>

    <p>
    <div class="navbar">
      <a href="./SWISH-LIBRARY.html">Prev</a> |
      <a href="./index.html">Contents</a> |
      <a href="./SWISH-3.0.html">Next</a>
    </div>
    <p>

    <div class="toc">
      
<A NAME="toc"></A>
<P><B>Table of Contents:</B></P>

<UL>

	<LI><A HREF="#SYNOPSIS">SYNOPSIS</A>
	<LI><A HREF="#ABSTRACT">ABSTRACT</A>
	<LI><A HREF="#INSTALLATION">INSTALLATION</A>
	<LI><A HREF="#FUNCTION_DESCRIPTIONS">FUNCTION DESCRIPTIONS</A>
	<LI><A HREF="#SUPPORT">SUPPORT</A>
	<LI><A HREF="#AUTHOR">AUTHOR</A>
	<LI><A HREF="#SEE_ALSO">SEE ALSO</A>
	<LI><A HREF="#Document_Info">Document Info</A>
</UL>

    </div>

    

	    [ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>

<P>
<H1><A NAME="SYNOPSIS">SYNOPSIS</A></H1>
<P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    use SWISHE;</pre>
        </td>
	    
      </tr>
    </table>
    <P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    my $indexfilename1 = '/path/to/index1.swish';
    my $indexfilename2 = '/path/to/index2.swish';</pre>
        </td>
	    
      </tr>
    </table>
    <P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    # To search for several indexes just put them together
    $indexfiles = &quot;$indexfilename1 $indexfilename2&quot;;</pre>
        </td>
	    
      </tr>
    </table>
    <P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    my $handle = SwishOpen( $indexfiles )
        or die &quot;Failed to open '$indexfiles'&quot;;</pre>
        </td>
	    
      </tr>
    </table>
    <P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    # Get a few headers from the index files
    my @headers = qw/WordCharacters BeginCharacters EndCharacters/;
    for ( @headers ) {
        my @h = SwishHeaderParameter( $handle, $_ );
        print &quot;$_ for index 0 is $h[0]\n&quot;,
              &quot;$_ for index 1 is $h[1]\n\n&quot;;
    }</pre>
        </td>
	    
      </tr>
    </table>
    <P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    # Now search
    $props = 'prop1 prop2 prop3';
    $sort  = 'prop1 asc prop2 desc';
    $query = 'meta1=metatest1';</pre>
        </td>
	    
      </tr>
    </table>
    <P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    my $num_results = SwishSearch($handle, $query, 1, $props, $sort);</pre>
        </td>
	    
      </tr>
    </table>
    <P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    unless ( $num_results ) {
        print &quot;No Results\n&quot;;</pre>
        </td>
	    
      </tr>
    </table>
    <P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>        my $error = SwishError( $handle );
        print &quot;Error number: $error\n&quot; if $error;</pre>
        </td>
	    
      </tr>
    </table>
    <P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>        return;  # or next.
    }</pre>
        </td>
	    
      </tr>
    </table>
    <P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    while( my($rank,$index,$file,$title,$summary,$start,$size,@props) = SwishNext( $handle )) {
        print join( ' ',
              $rank,
              $index,
              $file,
              qq[&quot;$title&quot;],
              qq[&quot;$summary&quot;],
              $start,
              $size,
              map{ qq[&quot;$_&quot;] } @props,
              ),&quot;\n&quot;;
    }</pre>
        </td>
	    
      </tr>
    </table>
    <P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    # No more queries on these indexes
    SwishClose( $handle );</pre>
        </td>
	    
      </tr>
    </table>
    <P>
[ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>
<H1><A NAME="ABSTRACT">ABSTRACT</A></H1>
<P>
SWISHE version 2.1.x creates an archive library of the internal SWISHE C
functions. This perl module provides access to those functions by embedding
the SWISHE search code in your application. The benefits are faster
searches (no need to fork/execute an external program) and avoids commonly
used unsafe system calls.

<P>
This module provides direct access to the SWISHE C library functions. For a
higher level, object oriented interface to SWISH visit <A
HREF="http://search.cpan.org/search?mode=module&query=SWISH">http://search.cpan.org/search?mode=module&query=SWISH</A>


<P>
[ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>
<H1><A NAME="INSTALLATION">INSTALLATION</A></H1>
<P>
Before you can build the perl module you must build and install SWISH-E.
Please read the
<STRONG>INSTALL</STRONG> documentation included in the SWISHE distribution package.

<P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    perldoc INSTALL</pre>
        </td>
	    
      </tr>
    </table>
    <P>
After building the SWISHE executable and successfully running make test,
you will need to install the SWISHE archive library. This is done while in
the top-level directory of the SWISHE distribution.

<P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    % su root
    % make install-lib
    % exit</pre>
        </td>
	    
      </tr>
    </table>
    <P>
<STRONG>Jose: What's the best way to install if the user doesn't have root access? Set LD_LIBRARY_PATH??</STRONG>



<P>
This will install the archive library (<EM>libswish-e.a</EM>) into /usr/local/lib by default.

<P>
Next, build the perl module.

<P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    % cd perl
    % perl Makefile.PL
    % make
    % make test
    % su root
    % make install
    % exit</pre>
        </td>
	    
      </tr>
    </table>
    <P>
If you do not have root access you can instead use

<P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    % perl Makefile.PL PREFIX=/path/to/my/local/perl/library</pre>
        </td>
	    
      </tr>
    </table>
    <P>
And then in your perl script:

<P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    use lib '/path/to/my/local/perl/library';</pre>
        </td>
	    
      </tr>
    </table>
    <P>
To test it you can run the test.pl script. Type ``./test.pl'' at your
command prompt. This perl script uses the index file built by the ``make
test'' command used during the build of SWISHE as described in the <STRONG>INSTALL</STRONG> document.

<P>
[ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>
<H1><A NAME="FUNCTION_DESCRIPTIONS">FUNCTION DESCRIPTIONS</A></H1>
<P>
The following describes the perl interface to the SWISHE C library.

<DL>
<P><DT><STRONG><A NAME="item__handle">$handle = SwishOpen( $IndexFiles );</A></STRONG><DD>
<P>
Open one or more index files and returns a handle.

<P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    Examples:</pre>
        </td>
	    
      </tr>
    </table>
    <P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>        $handle = SwishOpen( 'index_file.idx' );</pre>
        </td>
	    
      </tr>
    </table>
    <P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>        # open two indexes
        $handle = SwishOpen( 'index1.idx index2.idx' );</pre>
        </td>
	    
      </tr>
    </table>
    <P>
<STRONG>Question: How do you get the error string if this fails?</STRONG>



<P><DT><STRONG><A NAME="item_SwishClose">SwishClose( $handle );</A></STRONG><DD>
<P>
Closes the handle returned by SwishOpen. Closes all the opened files and
frees the used memory.

<P>
<STRONG>Question: Is there a return value?</STRONG>



<P><DT><STRONG><A NAME="item__num_results">$num_results = SwishSearch($handle, $search, $structure, $properties, $sortspec);</A></STRONG><DD>
<P>
Returns the number of hits, zero for no results, or a negative number. If
zero <CODE>SwishError(</CODE> <CODE>$handle</CODE> ) will return the error
code. A typical error code would be -10 (WORD_NOT_FOUND).

<P>
<STRONG>Is this true?</STRONG>



<P>
The values passed are:

<UL>
<P><LI>
<P>
<CODE>$handle</CODE> is the handle returned by SwishOpen

<P><LI>
<P>
<CODE>$search</CODE> is the search string.

<P>
Examples: my <CODE>$query</CODE> = 'title=``this a is phrase'''; my
<CODE>$query</CODE> = '(title=``this phrase'') or (description=(these
words))';

<P><LI>
<P>
<CODE>$structure</CODE> is an integer value only applicable for an html
search. It defines where in an html search to look. It can be IN_FILE,
IN_TITLE, IN_HEAD, IN_BODY, IN_COMMENTS, IN_HEADER or IN_EMPHASIZED or
or'ed combinations of them (e.g.: IN_HEAD | IN_BODY). Use IN_FILE (a value
of 1) if your documents are not html. The numerical values for IN_FILE,
IN_HEAD are in src/swish.h

<P><LI>
<P>
<CODE>$properties</CODE> is a string with the properties to be returned
separated by spaces. Properties must be defined during indexing. See <STRONG>README-SWISHE</STRONG> for more information.

<P>
Example: my <CODE>$properties</CODE> = 'subject description';

<P><LI>
<P>
<CODE>$sortspec</CODE> is the sort spec if different from relevance.

<P>
Examples: my <CODE>$sortspec</CODE> = '' # sort by relevance

<P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    # sort first in ascending order by title,
    # then by other fields in descending order
    my $sortspec = 'title asc category desc category desc';</pre>
        </td>
	    
      </tr>
    </table>
    </UL>
<P>
<STRONG>QUESTION: Does this return a swish error, or do you have to call SwishError()?</STRONG>



<P><DT><STRONG><A NAME="item_SwishNext">SwishNext( $handle )</A></STRONG><DD>
<P>
($rank, $indexfile, $filename, $title, $start, $size, @properties) =
<CODE>SwishNext(</CODE> <CODE>$handle</CODE> );

<P>
This function returns the next hit of a search. Must be executed after
SwishSearch to read the results.

<UL>
<P><LI>
<P>
<CODE>$rank</CODE> - An integer from 1 to 1000 indicating the relevance of
the result

<P><LI>
<P>
<CODE>$filename</CODE> - The source filename

<P><LI>
<P>
<CODE>$title</CODE> - The title as indexed (as found in the HTML &lt;TITLE&gt; section)

<P><LI>
<P>
<CODE>$start</CODE> * - The starting position in the file of the record

<P><LI>
<P>
<CODE>$size</CODE> - The length of the source document

<P><LI>
<P>
<CODE>@properties</CODE> - The list of properties returned for this result.

</UL>
<P>
Example:

<P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    while(($rank,$indexfile,$filename,$title,$start,$size,@properties)=SwishNext($handle)) {</pre>
        </td>
	    
      </tr>
    </table>
    <P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>        print join( ' ',
              $rank,
              $indexfile,
              $filename,
              qq[&quot;$title&quot;],
              $start,
              $size,
              map{ qq[&quot;$_&quot;] } @properties,
              ),&quot;\n&quot;;
    }</pre>
        </td>
	    
      </tr>
    </table>
    <P><DT><STRONG><A NAME="item__rc_SwishSeek_handle_">$rc=SwishSeek($handle, $num);</A></STRONG><DD>
<P>
Repositions the pointer in the result list to the element pointed by num.
It is useful when you want to read only the results starting at
<CODE>$num</CODE> (e.g. for showing results one page at a time).

<P><DT><STRONG><A NAME="item__rc_SwishError_handle_">$rc=SwishError($handle);</A></STRONG><DD>
<P>
Returns the last error if any (always a negative value). If there is not an
error it will return 0.

<P>
<STRONG>Question: Should there be a way to return the error string?</STRONG>



<P><DT><STRONG><A NAME="item__ParameterArray_SwishHeaderParam">@ParameterArray=SwishHeaderParameter($handle,$HeaderParameterName);</A></STRONG><DD>
<P>
This function is useful to access the header data of the index files
Returns the contents of the requested header parameter of all index files
opened by SwishOpen in an array.

<P>
Example:

<P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    @wordchars = SwishHeaderParameter( $handle, 'WordCharacters' );
    print &quot;WordCharacters for index 0 = $wordchars[0]\n&quot;;
    print &quot;WordCharacters for index 1 = $wordchars[1]\n&quot;;</pre>
        </td>
	    
      </tr>
    </table>
    <P>
Valid values for HeaderParameterName are: WordCharacters BeginCharacters
EndCharacters IgnoreFirstChar IgnoreLastChar Indexed on Description
IndexPointer IndexAdmin Stemming Soundex

<P><DT><STRONG><A NAME="item__stopwords">@stopwords = SwishStopWords( $handle, $indexfilename );</A></STRONG><DD>
<P>
Returns an array containing all the stopwords stored in the index file
pointed by <CODE>$indexfilename</CODE> where <CODE>$indexfilename</CODE>
must match one of the names used in SwishOpen.

<P>
Example: <CODE>@stopwords</CODE> = <CODE>SwishStopWords(</CODE> $handle,
<CODE>$indexfilename</CODE> ); print 'Stopwords: ', <CODE>join(',</CODE> ',
@stopwords), ``\n'';

<P><DT><STRONG><A NAME="item__keywords">@keywords = SwishWords( $handle, $indexfilename, $c);</A></STRONG><DD>
<P>
Returns an array containing all the keywords stored in the index file
pointed by <CODE>$indexfilename</CODE> ($indexfilename must match one of
the names used in SwishOpen) and starting with the character $c.

<P>
Example: my <CODE>$letter</CODE> = 't'; <CODE>@keywords</CODE> =
<CODE>SwishWords(</CODE> $handle, $indexfilename, $letter);

<P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    print &quot;List of keywords that start with the letter '$letter':\n&quot;,
          join(&quot;\n&quot;, @keywords),
          &quot;\n&quot;;</pre>
        </td>
	    
      </tr>
    </table>
    <P><DT><STRONG><A NAME="item__stemword_SwishStem_">$stemword=SwishStem( $word );</A></STRONG><DD>
<P>
Returns the stemmed word preserving the original one.

<P>
Example: my <CODE>$stemword</CODE> = <CODE>SwishStem(</CODE> 'parking' );
print $stem_word; # prints park

</DL>
<P>
[ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>
<H1><A NAME="SUPPORT">SUPPORT</A></H1>
<P>
Questions about this module and SWISHE should be posted to the SWISHE
mailing list. See <A
HREF="http://sunsite.berkeley.edu/SWISH-E/.">http://sunsite.berkeley.edu/SWISH-E/.</A>


<P>
[ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>
<H1><A NAME="AUTHOR">AUTHOR</A></H1>
<P>
Jose Ruiz -- <A HREF="mailto:jmruiz@boe.es">jmruiz@boe.es</A>

<P>
[ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>
<H1><A NAME="SEE_ALSO">SEE ALSO</A></H1>
<P>
<A
HREF="http://sunsite.berkeley.edu/SWISH-E/">http://sunsite.berkeley.edu/SWISH-E/</A>


<P>
SWISH, SWISH::Library at your local CPAN site.

<P>
[ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>
<H1><A NAME="Document_Info">Document Info</A></H1>
<P>
$Id$

<P>
.

[ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>



    <p>
    <div class="navbar">
      <a href="./SWISH-LIBRARY.html">Prev</a> |
      <a href="./index.html">Contents</a> |
      <a href="./SWISH-3.0.html">Next</a>
    </div>
    <p>

    <P ALIGN="CENTER">
    <IMG ALT="" WIDTH="470" HEIGHT="10" SRC="images/dotrule1.gif"></P>
    <P ALIGN="CENTER">

    <div class="footer">
        Copyright (C) 1995, 1996, 1997, 1998, 1999, 2000 Hewlett-Packard Company<BR>
        Originally by Kevin Hughes, kev@kevcom.com, March 11, 1994.
        <BR>SWISH-E is distributed with <B>no warranty</B> under the terms of the <A 
        HREF="http://www.fsf.org/copyleft/gpl.html">GNU Public License</A>,<BR>
        Free Software Foundation, Inc., 
        59 Temple Place - Suite 330, Boston, MA  02111-1307, USA<BR> 
        Public questions may be posted to 
        the <A HREF="http://sunsite.berkeley.edu/SWISH-E/Discussion/">SWISH-E Discussion</A>.
    </div>

</body>
</html>
